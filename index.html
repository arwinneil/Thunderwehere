<!-- saved from url=(0097)https://google-developers.appspot.com/maps/documentation/javascript/examples/full/map-geolocation -->
<html>
  <head>
    <title>Geolocation</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta charset="utf-8" />

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"
      integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
      crossorigin=""
    />

    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script
      src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
      integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
      crossorigin=""
    ></script>

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.0/css/bulma.min.css"
    />
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }

      /* Optional: Makes the sample page fill the window. */
      html,
      body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>

  <body>
    <script>
      var mymap, infoWindow, center;

      var array = [];
      // function initMap() {
      //   map = new google.maps.Map(document.getElementById("map"), {
      //     center: { lat: -34.397, lng: 150.644 },
      //     zoom: 13
      //   });
      //   infoWindow = new google.maps.InfoWindow();

      // Try HTML5 geolocation.
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          var pos = {
            lat: position.coords.latitude,
            lng: position.coords.longitude
          };

          center = pos;

          //infoWindow.setPosition(pos);
          //infoWindow.setContent("Location found.");
          //infoWindow.open(map);
          // map.setCenter(pos);

          mymap = L.map("map").setView(center, 13);

          L.tileLayer(
            "https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}",
            {
              attribution:
                'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
              maxZoom: 18,
              id: "mapbox.streets",
              accessToken:
                "pk.eyJ1IjoiYXJ3aW5uZWlsIiwiYSI6ImNqczh2b214ZjBnYjMzeXBxcm4zNXdqMmQifQ.RnbmbGtcTHnAvAieMvWWLw"
            }
          ).addTo(mymap);

          L.marker(center)
            .addTo(mymap)
            .bindPopup("You are here!")
            .openPopup();
        });
      }

      var startTime, endTime;

      function start() {
        startTime = new Date();
      }

      function end() {
        while (array.length) {
          array.pop().setMap(null);
        }

        array.length = 0;

        endTime = new Date();
        var timeDiff = endTime - startTime; //in ms
        // strip the ms
        //timeDiff /= 1000;

        // get seconds
        var seconds = Math.round(timeDiff);
        console.log(seconds + " ms");

        var radius = (seconds / 1000) * 343;

        array.push(
          L.circle(center, {
            color: "red",
            fillColor: "#f03",
            fillOpacity: 0.5,
            radius: radius,
            stroke: 1
          }).addTo(mymap)
        );

        array[0].bindPopup(radius + "m").openPopup();
        //map.fitBounds(array[0].getBounds());
      }
    </script>

    <div class="columns">
      <div class="column is-one-quarter">
        <section class="hero">
          <div class="hero-body">
            <div class="container">
              <h1 class="title">
                ThunderWhere ðŸŒ©
              </h1>
            </div>
          </div>
        </section>

        <div class="field is-grouped">
          <p class="control">
            <a class="button " onclick="start()">I SEE LIGHTINGâš¡</a>
          </p>
          <p class="control">
            <a class="button" onclick="end()">I HEAR THUNDER ðŸ“¢</a>
          </p>
        </div>

        <p class="is-size-7">
          Sound travels through air at "the speed of sound." Officially, the
          speed of sound is 331.3 meters per second (1,087 feet per second) in
          dry air at 0 degrees Celsius (32 degrees Fahrenheit). At a temperature
          like 28 degrees C (82 degrees F), the speed is 346 meters per second.
          As you can see, the speed of sound changes depending on the
          temperature and the humidity; but if you want a round number, then
          something like 350 meters per second and 1,200 feet per second are
          reasonable numbers to use. So sound travels 1 kilometer in roughly 3
          seconds and 1 mile in roughly 5 seconds. When you see the flash of a
          lightning bolt, you can start counting seconds and then divide to see
          how far away the lightning struck. If it takes 10 seconds for the
          thunder to roll in, the lightning struck about 2 miles or 3 kilometers
          away.
        </p>
      </div>

      <div class="column">
        <div id="map"></div>
      </div>
    </div>

    <script
      async
      defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBBLyWj-3FWtCbCXGW3ysEiI2fDfrv2v0Q&&callback=initMap"
    ></script>
  </body>
</html>
